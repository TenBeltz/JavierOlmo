---
import { Image } from 'astro:assets';
import Questions from '../../public/images/services/questions.png';
---
<div class="w-full flex flex-col items-center justify-center my-4" id="FAQ">
  <h3 class="text-5xl font-bold text-white">FAQ</h3>
  <p class="text-white font-semibold">Preguntas frecuentes</p>
</div>

<section class="w-full h-fit flex flex-col items-center md:flex-row justify-center space-y-5 md:space-y-0 md:space-x-4">
  <div class="w-10/12 md:w-1/4 flex flex-col space-y-4" id="faq-section">
  </div>

  <div class="w-10/12 md:w-1/4 h-fit flex justify-center items-center flex-col space-y-1">
    <div class="w-full flex justify-center">
      <Image src={Questions} alt="Logo" class="w-40"/>
    </div>
    <h3 class="text-2xl text-white font-bold">¿Alguna pregunta más?</h3>
    <h5 class="text-white text-md text-center">Déjame tus dudas en el correo y me pondré en contacto contigo</h5>
    <div class="px-4 flex items-center bg-white h-10 rounded-xl text-center w-fit">
      hola@javierolmotraining.es
    </div>
  </div>
</section>

<script>
  // URL de la API
  const apiUrl = 'https://www.padelchiquito.com/api/jolmo/faqs/';

  // Función para crear el HTML de cada FAQ
  function createFAQItem(pregunta, respuesta) {
    return `
<div class="faq-item h-auto w-full">
  <div class="w-full bg-white rounded-lg px-2 py-2 flex items-center flex-row justify-between relative">
    <h4 class="text-lg font-semibold">${pregunta}</h4>
    <button class="toggle-button text-white bg-electric-lime rounded-full w-6 h-6 font-extrabold">+</button>
  </div>
  <p class="text-white mt-2 hidden w-full break-words">${respuesta}</p>
</div>

    `;
  }

  // Función para cargar las FAQs desde la API y agregar el HTML
  async function loadFAQs() {
    try {
      const response = await fetch(apiUrl);
      const faqs = await response.json();

      const faqSection = document.getElementById('faq-section');
      faqSection.innerHTML = faqs.map(faq => createFAQItem(faq.pregunta, faq.respuesta)).join('');

      // Agregar el evento de clic a los botones una vez cargadas las FAQs
      document.querySelectorAll('.faq-item').forEach(item => {
        const button = item.querySelector('.toggle-button');
        const answer = item.querySelector('p');

        button.addEventListener('click', () => {
          const isVisible = !answer.classList.contains('hidden');
          answer.classList.toggle('hidden');
          button.textContent = isVisible ? '+' : '-';
        });
      });
    } catch (error) {
      console.error('Error al cargar las FAQs:', error);
    }
  }

  // Cargar las FAQs al cargar la página
  document.addEventListener('DOMContentLoaded', loadFAQs);
</script>

<script>
  document.querySelectorAll('.faq-item').forEach(item => {
    const button = item.querySelector('.toggle-button');
    const answer = item.querySelector('p');

    button.addEventListener('click', () => {
      const isVisible = !answer.classList.contains('hidden');
      answer.classList.toggle('hidden');
      button.textContent = isVisible ? '+' : '-';
    });
  });
</script>
